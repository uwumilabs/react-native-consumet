#!/bin/sh
set -e
yarn prepare

# Run zoro test but don't fail if it errors
echo "🧪 Running Zoro test (errors allowed)..."
if ! yarn test zoro.test.ts; then
  echo "⚠️ Zoro test failed, but continuing..."
fi

# All other checks are strict
yarn lint-staged
echo "🛠 Running TypeScript check..."
yarn typecheck
echo "✅ TypeScript check completed"

echo "📦 Building dist folder..."
yarn build:clean
if [ -d "dist" ]; then
  echo "✅ Dist folder exists, adding to git..."
  git add dist/
  echo "✅ Dist folder added to commit"
else
  echo "❌ Dist folder not found after build!"
  exit 1
fi
